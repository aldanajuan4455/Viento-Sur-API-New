{% extends '::base.html.twig' %}

{% block title %}Viento Sur{% endblock %}

{% block stylesheets %}
{% endblock %}

{% block content %}
{% endblock %}

{% block javascripts %}
    <script src="{{ asset('js/hotels.js') }}" type="text/javascript"></script>
    {#<script src="{{ asset('bundles/vientosurappapp/js/AutoComplete/jquery.mockjax.js')}}" type="text/javascript"></script>#}
    <script src="{{ asset('assets/vendor/devbridge-autocomplete/dist/jquery.autocomplete.min.js')}}" type="text/javascript"></script>
    <script src="{{ asset('bundles/vientosurappapp/js/nicescroll.js') }}" type="text/javascript"></script>
    <script src="{{ asset('js/dropit.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/vientosurappapp/js/ionrangeslider.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/vientosurappapp/js/icheck.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/vientosurappapp/js/fotorama.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/vientosurappapp/js/typeahead.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/vientosurappapp/js/card-payment.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/vientosurappapp/js/magnific.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/vientosurappapp/js/owl-carousel.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/vientosurappapp/js/fitvids.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/vientosurappapp/js/tweet.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/vientosurappapp/js/countdown.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/vientosurappapp/js/gridrotator.js') }}" type="text/javascript"></script>
    <script src="{{ asset('js/custom.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/vendor/bootpag/lib/jquery.bootpag.min.js') }}" type="text/javascript"></script>
    <script type="text/javascript">
        $(function() {
            var url = Routing.generate('despegar_autocomplete');
            $('#autocomplete').on('click', function () {
                $(this).select();
            });
            $('#autocomplete').on('blur', function () {
                setTimeout(function () {
                    if ($("#destinationCity").val() == '') {
                        $('#autocomplete').val('');
                    }
                }, 200)
            });
            $('#autocomplete').autocomplete({
                serviceUrl: url,
                onSelect: function (suggestion) {
                    $("#destinationCity").val(suggestion.data.id);
                },
                minChars: 3,
                groupBy: 'category',
                onInvalidateSelection: function () {
                    console.log("invalidado");
                    $("#destinationCity").val('');
                }
            });

        });
        $('#submitConsult').on('show.bs.modal', function (e) {
            $title = $(e.relatedTarget).attr('data-title');
            $(this).find('.modal-title').text($title);

            // Pass path reference to modal form submission on yes/ok

            var path = $(e.relatedTarget).attr('data-path');
            $(this).find('.modal-footer #confirmConsult').data('path', path);

            //$(this).find('.modal-body').load('{#{ path('viento_sur_app_consult') }#}');
        });


        $('#submitConsult').find('.modal-footer #confirmConsult').on('click', function () {
            if ($('#observacion').val()==="") {
                // invalid
                $("#requerido").text("Debe indicar una observaci√≥n");
                return false;
            }
            else {
                var url = $(this).data('path');
                var data = {
                    fullname: $('#fullnameField').val(),
                    email: $('#emailField').val(),
                    message: $('#messageField').val()
                };
                $.ajax({
                    type: 'post',
                    url: url,
                    data: data,
                    success: function(data) {
                        //$('#submitConsult').modal('hide');
                        //location.reload();
                        $('#submitConsult').modal('hide');
                        $('#DataTable').DataTable().ajax.reload(null, false);
                    }
                });
                return true;
            }
        });

        $('#submitConsult').on('hidden.bs.modal', function (e) {
            // do something...
        });

        $(document).ready(function () {
            var dateFormat = "dd/mm/yy";
            var dayNamesMin = ["Do", "Lu", "Ma", "Mi", "Ju", "Vi", "Sa"];
            var monthNames = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
            var from = $("#field-hotel-checkin").datepicker({
                dateFormat: dateFormat,
                dayNamesMin: dayNamesMin,
                monthNames: monthNames,
                defaultDate: "+1w",
                numberOfMonths: 2,
                minDate: 0
            }).on("change", function () {
                to.datepicker("option", "minDate", getDate(this));
                console.log(getDate(this));
            });
            var to = $("#field-hotel-checkout").datepicker({
                dateFormat: dateFormat,
                dayNamesMin: dayNamesMin,
                monthNames: monthNames,
                defaultDate: "+1w",
                numberOfMonths: 2
            }).on("change", function () {
                from.datepicker("option", "maxDate", getDate(this));
            });

            function getDate(element) {
                var date;
                try {
                    date = $.datepicker.parseDate(dateFormat, element.value);
                } catch (error) {
                    console.log(error);
                    date = null;
                }
                return date;
            }
        });
    </script>
    <script>(function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/es_LA/sdk.js#xfbml=1&version=v2.7";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
    </script>
{% endblock %}
